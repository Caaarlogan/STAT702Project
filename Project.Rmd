---
title: "Project"
author: "Carlo Carbonilla"
date: "13/05/2021"
output:
  html_document:
    df_print: paged
---

Load the required Packages.

```{r}
#Loading the Packages
library(dplyr)
library(tidyverse)
library(lubridate)
```

Question 1. 

Solution 1.a) 

Import the data from STAT702_project_sales_data.csv file.

```{r}
sales <- read.csv(file = 'STAT702_project_sales_data.csv')
head(sales)
```

To format week as a date, first step is to Convert week column from character to date type.
And then, use the lubridate function to extract the month.

```{r}
sales$week <- as.Date(sales$week, format =  "%d/%m/%y")
head(sales)
```

Given the project requirements, Filtering dataframe to dates in 2012 and with the product sku of 216419 (assigned to group #2)

```{r}
productSales <- sales %>% filter(sku_id == 216419)
productSales
```

Here the variables Month and Year witholds the total number of units sold by month and year respectively,

```{r}
Month <- month(productSales$week)
Year <- year(productSales$week)

monthlySales <- aggregate(cbind(units_sold)~Month+Year,
             data=productSales,FUN=sum)

monthlySales$MonthYear <- as.Date(paste(1,monthlySales$Month,monthlySales$Year,sep="/"), format="%d/%m/%Y")

monthlySales
```

There are 31 rows resides in the table where each row represents a month starting from January 2011 all the way till July 2013 (31 Months).

Furtherfore, this table has laid the foundation to help plotting the data on a graph to observe any trends/patterns. 

```{r}
ggplot(monthlySales, aes(MonthYear, units_sold, group=1)) + 
  geom_line() +
  geom_point() +
  scale_x_date(date_breaks = "1 month", date_labels = "%m-%Y") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  ggtitle("Monthly Sales") +
  xlab("Month and Year") +
  ylab("Units Sold")
```


This plot shows that the montly sales over a period of time for the Product ID- 216419 which has been fluctuating with in \$15000 and \$25000. However, the sales went unreasonably over $35000 in January 2012 which could be either because of New year's holiday weekend or some other unknown factors. It's best to remove the July 2013 sales out of the analysis it only contains 7 days sales total. 
To sum it up, this plot describes the increase and decrease in product sale each month



Solution 1.b) 

Sum total units sold by each store
```{r}
StoreID <- productSales$store_id

storeSales <- aggregate(cbind(units_sold)~StoreID,
             data=productSales,FUN=sum)

storeSales$StoreID <- as.character(storeSales$StoreID)

storeSales
```

```{r}
ggplot(data=storeSales, aes(x=reorder(StoreID, -units_sold), y=units_sold)) +
  geom_bar(stat="identity", fill="steelblue") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(title = "Total Units Sold of Stores", y = "Units Sold", x = "Store ID")
```

Summary of all sales
```{r}
summary(storeSales)
```

```{r}
top10Sales <- head(storeSales %>% arrange(desc(units_sold)),10)
top10Sales
```

Graph of Top 10 Stores
```{r}
ggplot(data=top10Sales, aes(x=reorder(StoreID, -units_sold), y=units_sold)) +
  geom_bar(stat="identity", fill="steelblue") +
  geom_text(aes(label=units_sold), vjust=1.6, color="white", size=3.5) +
  labs(title = "Top 10 Stores in Units Sold", y = "Units Sold", x = "Store ID")
```
```{r}
summary(top10Sales)
```

Bottom 10 Stores in Units Sold
```{r}
bottom10Sales <- head(storeSales %>% arrange(units_sold),10)
bottom10Sales
```

Graph of Bottom 10 Stores
```{r}
ggplot(data=bottom10Sales, aes(x= reorder(StoreID, units_sold), y=units_sold)) +
  geom_bar(stat="identity", fill="steelblue") +
  geom_text(aes(label=units_sold), vjust=1.6, color="white", size=3.5) +
  labs(title = "Bottom 10 Stores in Units Sold", y = "Units Sold", x = "Store ID")
```
```{r}
summary(bottom10Sales)
```

Question 2.

Filter dataframe to dates in 2012 and with the product sku of 216233
```{r}
productSales2012 <- sales %>% filter(week >= as.Date("2012-01-01"), week <= as.Date("2012-12-31"), sku_id == 216233)
head(productSales2012)
```

i.
```{r}
productSales2012
```

Setup cost = $130 per order
Holding cost = $1.50 per unit per year

k = order or setup cost
A = Number of items demanded per annum
c = purchase cost per item
h = holding cost per item per annum
Q* = optimum order quantity (number of items)
T = time between order = length of the inventory cycle = Q/A


Tc = Annual inventory cost = Annual order cost + Annual holding cost
   = 130*Q + 1.5

Question 3.

Load the data

```{r}
review <- read.csv(file = 'STAT702_project_reviews_data.csv')
head(review)
```

Filter the product given to our group

```{r}
selectedProduct <- review %>% filter(asin == "B00005249G")
selectedProduct
```

```{r}
summary(selectedProduct)
```


```{r}
ggplot(selectedProduct, aes(overall)) + 
  geom_bar() 
```


Explanation:



3b)

Start here:


```{r}
library(dplyr)
data <- selectedProduct %>%
mutate(linenumber = row_number());
head(data)
```


```{r}
install.packages("tidytext")
library(tidytext)
```

```{r}

```

